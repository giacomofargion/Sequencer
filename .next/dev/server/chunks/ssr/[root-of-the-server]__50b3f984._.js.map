{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Projects24/Code/Sequencer/types/sequencer.ts"],"sourcesContent":["// Core data model for the step sequencer lives here so UI and audio can share it.\n\nexport type InstrumentId = \"kick\" | \"snare\" | \"hihat\" | \"tom\" | \"synth\";\n\nexport const INSTRUMENTS: InstrumentId[] = [\n  \"kick\",\n  \"snare\",\n  \"hihat\",\n  \"tom\",\n  \"synth\",\n];\n\nexport type StepState = {\n  active: boolean;\n  // In the future we can add per-step velocity, probability, etc.\n};\n\nexport type Pattern = StepState[][];\n\nexport type TransportState = {\n  isPlaying: boolean;\n  tempo: number;\n  startStep: number;\n  endStep: number;\n  currentStep: number;\n};\n\nexport type InstrumentParams = {\n  pitch: number;\n  decay: number;\n  timbre: number;\n};\n\nexport type InstrumentParamMap = Record<InstrumentId, InstrumentParams>;\n\nexport type SequencerState = {\n  pattern: Pattern;\n  transport: TransportState;\n  instruments: InstrumentParamMap;\n};\n\nexport const NUM_STEPS = 16;\n\nexport function createEmptyPattern(steps: number = NUM_STEPS): Pattern {\n  return INSTRUMENTS.map(() =>\n    Array.from({ length: steps }, () => ({ active: false })),\n  );\n}\n\nexport function createDefaultTransport(): TransportState {\n  return {\n    isPlaying: false,\n    tempo: 100,\n    startStep: 0,\n    endStep: NUM_STEPS - 1,\n    currentStep: 0,\n  };\n}\n\nexport function createDefaultInstrumentParams(): InstrumentParamMap {\n  return {\n    kick: { pitch: -12, decay: 0.6, timbre: 0.5 },\n    snare: { pitch: 0, decay: 0.4, timbre: 0.7 },\n    hihat: { pitch: 12, decay: 0.2, timbre: 0.8 },\n    tom: { pitch: -5, decay: 0.5, timbre: 0.6 },\n    synth: { pitch: 0, decay: 0.8, timbre: 0.5 },\n  };\n}\n"],"names":[],"mappings":"AAAA,kFAAkF;;;;;;;;;;;;;AAI3E,MAAM,cAA8B;IACzC;IACA;IACA;IACA;IACA;CACD;AA+BM,MAAM,YAAY;AAElB,SAAS,mBAAmB,QAAgB,SAAS;IAC1D,OAAO,YAAY,GAAG,CAAC,IACrB,MAAM,IAAI,CAAC;YAAE,QAAQ;QAAM,GAAG,IAAM,CAAC;gBAAE,QAAQ;YAAM,CAAC;AAE1D;AAEO,SAAS;IACd,OAAO;QACL,WAAW;QACX,OAAO;QACP,WAAW;QACX,SAAS,YAAY;QACrB,aAAa;IACf;AACF;AAEO,SAAS;IACd,OAAO;QACL,MAAM;YAAE,OAAO,CAAC;YAAI,OAAO;YAAK,QAAQ;QAAI;QAC5C,OAAO;YAAE,OAAO;YAAG,OAAO;YAAK,QAAQ;QAAI;QAC3C,OAAO;YAAE,OAAO;YAAI,OAAO;YAAK,QAAQ;QAAI;QAC5C,KAAK;YAAE,OAAO,CAAC;YAAG,OAAO;YAAK,QAAQ;QAAI;QAC1C,OAAO;YAAE,OAAO;YAAG,OAAO;YAAK,QAAQ;QAAI;IAC7C;AACF"}},
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Projects24/Code/Sequencer/app/hooks/useToneEngine.ts"],"sourcesContent":["// Audio engine hook that wraps Tone.js.\n// Keeps Tone-specific details here so UI stays simple and type-safe.\n\nimport { useEffect, useRef, useState } from \"react\";\nimport type * as ToneType from \"tone\";\nimport type {\n  InstrumentId,\n  InstrumentParamMap,\n  Pattern,\n  TransportState,\n} from \"@/types/sequencer\";\n\nexport type ToneEngineApi = {\n  ready: boolean;\n  transport: TransportState;\n  setTempo: (bpm: number) => void;\n  setRange: (startStep: number, endStep: number) => void;\n  togglePlay: () => void;\n  updatePattern: (pattern: Pattern) => void;\n  updateInstrumentParams: (params: InstrumentParamMap) => void;\n};\n\nexport function useToneEngine(\n  initialTransport: TransportState,\n  initialPattern: Pattern,\n  initialParams: InstrumentParamMap,\n): ToneEngineApi {\n  const [transport, setTransport] = useState<TransportState>(initialTransport);\n  const [ready, setReady] = useState(false);\n\n  const toneRef = useRef<ToneType | null>(null);\n  const patternRef = useRef<Pattern>(initialPattern);\n  const paramsRef = useRef<InstrumentParamMap>(initialParams);\n  const synthsRef =\n    useRef<Partial<Record<InstrumentId, ToneType.ToneAudioNode>>>();\n  const loopIdRef = useRef<string | number | null>(null);\n  const currentStepRef = useRef<number>(initialTransport.startStep);\n\n  // Lazy-load Tone.js on the client and create synths + clock.\n  useEffect(() => {\n    let cancelled = false;\n\n    const setup = async () => {\n      if (typeof window === \"undefined\") return;\n      const tone = await import(\"tone\");\n      if (cancelled) return;\n\n      toneRef.current = tone;\n\n      const synths: Partial<Record<InstrumentId, ToneType.ToneAudioNode>> = {\n        kick: new tone.MembraneSynth().toDestination(),\n        snare: new tone.NoiseSynth({\n          envelope: { attack: 0.001, decay: 0.2, sustain: 0 },\n        }).toDestination(),\n        hihat: new tone.MetalSynth({\n          envelope: { attack: 0.001, decay: 0.1, release: 0.01 },\n        }).toDestination(),\n        tom: new tone.MembraneSynth({\n          pitchDecay: 0.08,\n        }).toDestination(),\n        synth: new tone.FMSynth().toDestination(),\n      };\n\n      synthsRef.current = synths;\n      tone.Transport.bpm.value = initialTransport.tempo;\n\n      const instrumentsOrder: InstrumentId[] = [\n        \"kick\",\n        \"snare\",\n        \"hihat\",\n        \"tom\",\n        \"synth\",\n      ];\n\n      loopIdRef.current = tone.Transport.scheduleRepeat((time) => {\n        const toneModule = toneRef.current;\n        if (!toneModule || !synthsRef.current) return;\n\n        const stepIndex = currentStepRef.current;\n\n        patternRef.current.forEach((row, rowIndex) => {\n          const step = row[stepIndex];\n          if (!step?.active) return;\n\n          const instrument = instrumentsOrder[rowIndex];\n          const synth = synthsRef.current?.[instrument];\n          const params = paramsRef.current[instrument];\n\n          if (!synth || !params) return;\n\n          triggerInstrument(\n            instrument,\n            synth,\n            params,\n            toneModule,\n            time as unknown as number,\n          );\n        });\n\n        setTransport((prev) => {\n          const nextIndex =\n            prev.currentStep >= prev.endStep ? prev.startStep : prev.currentStep + 1;\n          currentStepRef.current = nextIndex;\n          return { ...prev, currentStep: nextIndex };\n        });\n      }, \"16n\");\n\n      setReady(true);\n    };\n\n    void setup();\n\n    return () => {\n      cancelled = true;\n      const tone = toneRef.current;\n      if (tone && loopIdRef.current != null) {\n        tone.Transport.clear(loopIdRef.current);\n      }\n    };\n    // We intentionally run this once; pattern/params are tracked via refs.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  const ensureStarted = async () => {\n    const tone = toneRef.current;\n    if (!tone) return;\n    if (tone.context.state !== \"running\") {\n      await tone.start();\n    }\n  };\n\n  const setTempo = (bpm: number) => {\n    setTransport((prev) => ({ ...prev, tempo: bpm }));\n    const tone = toneRef.current;\n    if (tone) {\n      tone.Transport.bpm.value = bpm;\n    }\n  };\n\n  const setRange = (startStep: number, endStep: number) => {\n    setTransport((prev) => {\n      const clampedCurrent = Math.min(Math.max(prev.currentStep, startStep), endStep);\n      currentStepRef.current = clampedCurrent;\n      return {\n        ...prev,\n        startStep,\n        endStep,\n        currentStep: clampedCurrent,\n      };\n    });\n  };\n\n  const togglePlay = async () => {\n    const tone = toneRef.current;\n    if (!tone) return;\n\n    await ensureStarted();\n\n    setTransport((prev) => {\n      const nextPlaying = !prev.isPlaying;\n      if (nextPlaying) {\n        tone.Transport.start();\n      } else {\n        tone.Transport.stop();\n        currentStepRef.current = prev.startStep;\n        return { ...prev, isPlaying: nextPlaying, currentStep: prev.startStep };\n      }\n      return { ...prev, isPlaying: nextPlaying };\n    });\n  };\n\n  const updatePattern = (pattern: Pattern) => {\n    patternRef.current = pattern;\n  };\n\n  const updateInstrumentParams = (params: InstrumentParamMap) => {\n    paramsRef.current = params;\n\n    const tone = toneRef.current;\n    const synths = synthsRef.current;\n    if (!tone || !synths) return;\n\n    (Object.keys(params) as InstrumentId[]).forEach((id) => {\n      const synth = synths[id];\n      const { pitch, decay, timbre } = params[id];\n      if (!synth) return;\n\n      // These mappings are intentionally simple and easy to tweak later.\n      if (id === \"kick\" || id === \"tom\") {\n        const drum = synth as unknown as ToneType.MembraneSynth;\n        drum.envelope.decay = decay;\n        drum.pitchDecay = 0.05 + timbre * 0.1;\n      } else if (id === \"snare\") {\n        const noise = synth as unknown as ToneType.NoiseSynth;\n        noise.envelope.decay = decay;\n      } else if (id === \"hihat\") {\n        const metal = synth as unknown as ToneType.MetalSynth;\n        metal.envelope.decay = decay;\n        // In modern Tone, many parameters are Signals; update via set/value, not direct assignment.\n        metal.set({ harmonicity: 5 + timbre * 5 });\n      } else if (id === \"synth\") {\n        const fm = synth as unknown as ToneType.FMSynth;\n        fm.envelope.decay = decay;\n        fm.set({ harmonicity: 1 + timbre * 3 });\n        fm.detune.value = pitch * 10;\n      }\n    });\n  };\n\n  return {\n    ready,\n    transport,\n    setTempo,\n    setRange,\n    togglePlay,\n    updatePattern,\n    updateInstrumentParams,\n  };\n}\n\nfunction triggerInstrument(\n  id: InstrumentId,\n  synth: ToneType.ToneAudioNode,\n  params: InstrumentParamMap[InstrumentId],\n  tone: typeof import(\"tone\"),\n  time: number,\n) {\n  const { pitch, decay } = params;\n\n  if (id === \"kick\") {\n    (synth as ToneType.MembraneSynth).triggerAttackRelease(\n      tone.Frequency(50, \"hz\").transpose(pitch).toFrequency(),\n      decay,\n      time,\n    );\n  } else if (id === \"tom\") {\n    (synth as ToneType.MembraneSynth).triggerAttackRelease(\n      tone.Frequency(100, \"hz\").transpose(pitch).toFrequency(),\n      decay,\n      time,\n    );\n  } else if (id === \"snare\") {\n    (synth as ToneType.NoiseSynth).triggerAttackRelease(decay, time);\n  } else if (id === \"hihat\") {\n    (synth as ToneType.MetalSynth).triggerAttackRelease(decay, time);\n  } else if (id === \"synth\") {\n    (synth as ToneType.FMSynth).triggerAttackRelease(\n      tone.Frequency(\"C4\").transpose(pitch).toFrequency(),\n      decay,\n      time,\n    );\n  }\n}\n"],"names":[],"mappings":"AAAA,wCAAwC;AACxC,qEAAqE;;;;;AAErE;;AAmBO,SAAS,cACd,gBAAgC,EAChC,cAAuB,EACvB,aAAiC;IAEjC,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,iNAAQ,EAAiB;IAC3D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAC;IAEnC,MAAM,UAAU,IAAA,+MAAM,EAAkB;IACxC,MAAM,aAAa,IAAA,+MAAM,EAAU;IACnC,MAAM,YAAY,IAAA,+MAAM,EAAqB;IAC7C,MAAM,YACJ,IAAA,+MAAM;IACR,MAAM,YAAY,IAAA,+MAAM,EAAyB;IACjD,MAAM,iBAAiB,IAAA,+MAAM,EAAS,iBAAiB,SAAS;IAEhE,6DAA6D;IAC7D,IAAA,kNAAS,EAAC;QACR,IAAI,YAAY;QAEhB,MAAM,QAAQ;YACZ,wCAAmC;;;YACnC,MAAM;YAKN,MAAM;YAiBN,MAAM;QA0CR;QAEA,KAAK;QAEL,OAAO;YACL,YAAY;YACZ,MAAM,OAAO,QAAQ,OAAO;YAC5B,IAAI,QAAQ,UAAU,OAAO,IAAI,MAAM;gBACrC,KAAK,SAAS,CAAC,KAAK,CAAC,UAAU,OAAO;YACxC;QACF;IACA,uEAAuE;IACvE,uDAAuD;IACzD,GAAG,EAAE;IAEL,MAAM,gBAAgB;QACpB,MAAM,OAAO,QAAQ,OAAO;QAC5B,IAAI,CAAC,MAAM;QACX,IAAI,KAAK,OAAO,CAAC,KAAK,KAAK,WAAW;YACpC,MAAM,KAAK,KAAK;QAClB;IACF;IAEA,MAAM,WAAW,CAAC;QAChB,aAAa,CAAC,OAAS,CAAC;gBAAE,GAAG,IAAI;gBAAE,OAAO;YAAI,CAAC;QAC/C,MAAM,OAAO,QAAQ,OAAO;QAC5B,IAAI,MAAM;YACR,KAAK,SAAS,CAAC,GAAG,CAAC,KAAK,GAAG;QAC7B;IACF;IAEA,MAAM,WAAW,CAAC,WAAmB;QACnC,aAAa,CAAC;YACZ,MAAM,iBAAiB,KAAK,GAAG,CAAC,KAAK,GAAG,CAAC,KAAK,WAAW,EAAE,YAAY;YACvE,eAAe,OAAO,GAAG;YACzB,OAAO;gBACL,GAAG,IAAI;gBACP;gBACA;gBACA,aAAa;YACf;QACF;IACF;IAEA,MAAM,aAAa;QACjB,MAAM,OAAO,QAAQ,OAAO;QAC5B,IAAI,CAAC,MAAM;QAEX,MAAM;QAEN,aAAa,CAAC;YACZ,MAAM,cAAc,CAAC,KAAK,SAAS;YACnC,IAAI,aAAa;gBACf,KAAK,SAAS,CAAC,KAAK;YACtB,OAAO;gBACL,KAAK,SAAS,CAAC,IAAI;gBACnB,eAAe,OAAO,GAAG,KAAK,SAAS;gBACvC,OAAO;oBAAE,GAAG,IAAI;oBAAE,WAAW;oBAAa,aAAa,KAAK,SAAS;gBAAC;YACxE;YACA,OAAO;gBAAE,GAAG,IAAI;gBAAE,WAAW;YAAY;QAC3C;IACF;IAEA,MAAM,gBAAgB,CAAC;QACrB,WAAW,OAAO,GAAG;IACvB;IAEA,MAAM,yBAAyB,CAAC;QAC9B,UAAU,OAAO,GAAG;QAEpB,MAAM,OAAO,QAAQ,OAAO;QAC5B,MAAM,SAAS,UAAU,OAAO;QAChC,IAAI,CAAC,QAAQ,CAAC,QAAQ;QAErB,OAAO,IAAI,CAAC,QAA2B,OAAO,CAAC,CAAC;YAC/C,MAAM,QAAQ,MAAM,CAAC,GAAG;YACxB,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,MAAM,EAAE,GAAG,MAAM,CAAC,GAAG;YAC3C,IAAI,CAAC,OAAO;YAEZ,mEAAmE;YACnE,IAAI,OAAO,UAAU,OAAO,OAAO;gBACjC,MAAM,OAAO;gBACb,KAAK,QAAQ,CAAC,KAAK,GAAG;gBACtB,KAAK,UAAU,GAAG,OAAO,SAAS;YACpC,OAAO,IAAI,OAAO,SAAS;gBACzB,MAAM,QAAQ;gBACd,MAAM,QAAQ,CAAC,KAAK,GAAG;YACzB,OAAO,IAAI,OAAO,SAAS;gBACzB,MAAM,QAAQ;gBACd,MAAM,QAAQ,CAAC,KAAK,GAAG;gBACvB,4FAA4F;gBAC5F,MAAM,GAAG,CAAC;oBAAE,aAAa,IAAI,SAAS;gBAAE;YAC1C,OAAO,IAAI,OAAO,SAAS;gBACzB,MAAM,KAAK;gBACX,GAAG,QAAQ,CAAC,KAAK,GAAG;gBACpB,GAAG,GAAG,CAAC;oBAAE,aAAa,IAAI,SAAS;gBAAE;gBACrC,GAAG,MAAM,CAAC,KAAK,GAAG,QAAQ;YAC5B;QACF;IACF;IAEA,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;QACA;IACF;AACF;AAEA,SAAS,kBACP,EAAgB,EAChB,KAA6B,EAC7B,MAAwC,EACxC,IAA2B,EAC3B,IAAY;IAEZ,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG;IAEzB,IAAI,OAAO,QAAQ;QAChB,MAAiC,oBAAoB,CACpD,KAAK,SAAS,CAAC,IAAI,MAAM,SAAS,CAAC,OAAO,WAAW,IACrD,OACA;IAEJ,OAAO,IAAI,OAAO,OAAO;QACtB,MAAiC,oBAAoB,CACpD,KAAK,SAAS,CAAC,KAAK,MAAM,SAAS,CAAC,OAAO,WAAW,IACtD,OACA;IAEJ,OAAO,IAAI,OAAO,SAAS;QACxB,MAA8B,oBAAoB,CAAC,OAAO;IAC7D,OAAO,IAAI,OAAO,SAAS;QACxB,MAA8B,oBAAoB,CAAC,OAAO;IAC7D,OAAO,IAAI,OAAO,SAAS;QACxB,MAA2B,oBAAoB,CAC9C,KAAK,SAAS,CAAC,MAAM,SAAS,CAAC,OAAO,WAAW,IACjD,OACA;IAEJ;AACF"}},
    {"offset": {"line": 236, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Projects24/Code/Sequencer/components/TransportControls.tsx"],"sourcesContent":["import type { FC } from \"react\";\n\ntype Props = {\n  tempo: number;\n  startStep: number;\n  endStep: number;\n  maxSteps: number;\n  isPlaying: boolean;\n  onTempoChange: (bpm: number) => void;\n  onRangeChange: (start: number, end: number) => void;\n  onTogglePlay: () => void;\n};\n\nexport const TransportControls: FC<Props> = ({\n  tempo,\n  startStep,\n  endStep,\n  maxSteps,\n  isPlaying,\n  onTempoChange,\n  onRangeChange,\n  onTogglePlay,\n}) => {\n  const handleStartChange = (value: number) => {\n    const clamped = Math.max(0, Math.min(value, endStep));\n    onRangeChange(clamped, endStep);\n  };\n\n  const handleEndChange = (value: number) => {\n    const clamped = Math.min(maxSteps - 1, Math.max(value, startStep));\n    onRangeChange(startStep, clamped);\n  };\n\n  return (\n    <section className=\"flex items-center justify-between border-b border-neutral-200 pb-3 text-xs\">\n      <div className=\"flex items-center gap-3\">\n        <button\n          type=\"button\"\n          onClick={onTogglePlay}\n          className=\"flex h-8 w-8 items-center justify-center rounded-full border border-neutral-400 bg-white text-[11px] uppercase tracking-[0.18em] text-neutral-700 shadow-sm transition hover:bg-neutral-100\"\n        >\n          {isPlaying ? \"❚❚\" : \"▶\"}\n        </button>\n        <div className=\"flex items-center gap-2\">\n          <span className=\"font-mono text-[11px] uppercase tracking-[0.2em] text-neutral-500\">\n            Tempo\n          </span>\n          <input\n            type=\"range\"\n            min={60}\n            max={180}\n            value={tempo}\n            onChange={(e) => onTempoChange(Number(e.target.value))}\n            className=\"h-1 w-40 accent-emerald-600\"\n          />\n          <span className=\"w-10 text-right font-mono text-[11px] text-neutral-700\">\n            {tempo}\n          </span>\n        </div>\n      </div>\n\n      <div className=\"flex items-center gap-4\">\n        <label className=\"flex items-center gap-1\">\n          <span className=\"font-mono text-[11px] uppercase tracking-[0.18em] text-neutral-500\">\n            Start\n          </span>\n          <input\n            type=\"number\"\n            min={1}\n            max={maxSteps}\n            value={startStep + 1}\n            onChange={(e) => handleStartChange(Number(e.target.value) - 1)}\n            className=\"w-14 rounded border border-neutral-300 bg-white px-1 py-0.5 text-right font-mono text-[11px]\"\n          />\n        </label>\n        <label className=\"flex items-center gap-1\">\n          <span className=\"font-mono text-[11px] uppercase tracking-[0.18em] text-neutral-500\">\n            End\n          </span>\n          <input\n            type=\"number\"\n            min={1}\n            max={maxSteps}\n            value={endStep + 1}\n            onChange={(e) => handleEndChange(Number(e.target.value) - 1)}\n            className=\"w-14 rounded border border-neutral-300 bg-white px-1 py-0.5 text-right font-mono text-[11px]\"\n          />\n        </label>\n      </div>\n    </section>\n  );\n};\n"],"names":[],"mappings":";;;;;;AAaO,MAAM,oBAA+B,CAAC,EAC3C,KAAK,EACL,SAAS,EACT,OAAO,EACP,QAAQ,EACR,SAAS,EACT,aAAa,EACb,aAAa,EACb,YAAY,EACb;IACC,MAAM,oBAAoB,CAAC;QACzB,MAAM,UAAU,KAAK,GAAG,CAAC,GAAG,KAAK,GAAG,CAAC,OAAO;QAC5C,cAAc,SAAS;IACzB;IAEA,MAAM,kBAAkB,CAAC;QACvB,MAAM,UAAU,KAAK,GAAG,CAAC,WAAW,GAAG,KAAK,GAAG,CAAC,OAAO;QACvD,cAAc,WAAW;IAC3B;IAEA,qBACE,8OAAC;QAAQ,WAAU;;0BACjB,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,MAAK;wBACL,SAAS;wBACT,WAAU;kCAET,YAAY,OAAO;;;;;;kCAEtB,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,WAAU;0CAAoE;;;;;;0CAGpF,8OAAC;gCACC,MAAK;gCACL,KAAK;gCACL,KAAK;gCACL,OAAO;gCACP,UAAU,CAAC,IAAM,cAAc,OAAO,EAAE,MAAM,CAAC,KAAK;gCACpD,WAAU;;;;;;0CAEZ,8OAAC;gCAAK,WAAU;0CACb;;;;;;;;;;;;;;;;;;0BAKP,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAM,WAAU;;0CACf,8OAAC;gCAAK,WAAU;0CAAqE;;;;;;0CAGrF,8OAAC;gCACC,MAAK;gCACL,KAAK;gCACL,KAAK;gCACL,OAAO,YAAY;gCACnB,UAAU,CAAC,IAAM,kBAAkB,OAAO,EAAE,MAAM,CAAC,KAAK,IAAI;gCAC5D,WAAU;;;;;;;;;;;;kCAGd,8OAAC;wBAAM,WAAU;;0CACf,8OAAC;gCAAK,WAAU;0CAAqE;;;;;;0CAGrF,8OAAC;gCACC,MAAK;gCACL,KAAK;gCACL,KAAK;gCACL,OAAO,UAAU;gCACjB,UAAU,CAAC,IAAM,gBAAgB,OAAO,EAAE,MAAM,CAAC,KAAK,IAAI;gCAC1D,WAAU;;;;;;;;;;;;;;;;;;;;;;;;AAMtB"}},
    {"offset": {"line": 388, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Projects24/Code/Sequencer/components/PatternGrid.tsx"],"sourcesContent":["import type { FC } from \"react\";\nimport { INSTRUMENTS, type Pattern } from \"@/types/sequencer\";\n\ntype Props = {\n  pattern: Pattern;\n  currentStep: number;\n  onToggleStep: (row: number, col: number) => void;\n};\n\nexport const PatternGrid: FC<Props> = ({\n  pattern,\n  currentStep,\n  onToggleStep,\n}) => {\n  return (\n    <section className=\"mt-3 flex flex-col gap-2\">\n      <div className=\"font-mono text-[11px] uppercase tracking-[0.2em] text-neutral-500\">\n        Pattern\n      </div>\n      <div className=\"overflow-x-auto\">\n        <div className=\"inline-grid grid-cols-[80px_repeat(16,minmax(24px,1fr))] border border-neutral-300 bg-white\">\n          <div className=\"border-r border-neutral-300 bg-neutral-100\" />\n          {pattern[0]?.map((_, col) => {\n            const isCurrent = col === currentStep;\n            return (\n              <div\n                key={col}\n                className={`flex h-7 items-center justify-center border-l border-neutral-200 text-[9px] font-mono text-neutral-400 ${\n                  isCurrent ? \"bg-emerald-50\" : \"\"\n                }`}\n              >\n                {col + 1}\n              </div>\n            );\n          })}\n\n          {INSTRUMENTS.map((instrument, row) => (\n            <Row\n              key={instrument}\n              label={instrument}\n              rowIndex={row}\n              rowSteps={pattern[row]}\n              currentStep={currentStep}\n              onToggleStep={onToggleStep}\n            />\n          ))}\n        </div>\n      </div>\n    </section>\n  );\n};\n\ntype RowProps = {\n  label: string;\n  rowIndex: number;\n  rowSteps: Pattern[number];\n  currentStep: number;\n  onToggleStep: (row: number, col: number) => void;\n};\n\nconst Row: FC<RowProps> = ({\n  label,\n  rowIndex,\n  rowSteps,\n  currentStep,\n  onToggleStep,\n}) => {\n  return (\n    <>\n      <div className=\"flex h-9 items-center justify-end border-t border-r border-neutral-200 bg-neutral-100 px-2 text-[11px] capitalize text-neutral-600\">\n        {label}\n      </div>\n      {rowSteps.map((step, col) => {\n        const isCurrent = col === currentStep;\n        const isActive = step.active;\n        return (\n          <button\n            key={col}\n            type=\"button\"\n            onClick={() => onToggleStep(rowIndex, col)}\n            className={`h-9 border-t border-l border-neutral-200 transition ${\n              isActive\n                ? \"bg-emerald-500/10 text-emerald-700\"\n                : \"bg-white hover:bg-neutral-50\"\n            } ${isCurrent ? \"ring-1 ring-emerald-500/70\" : \"\"}`}\n          >\n            {isActive && (\n              <span className=\"block text-xs leading-none text-emerald-600\">\n                ×\n              </span>\n            )}\n          </button>\n        );\n      })}\n    </>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;;;AAQO,MAAM,cAAyB,CAAC,EACrC,OAAO,EACP,WAAW,EACX,YAAY,EACb;IACC,qBACE,8OAAC;QAAQ,WAAU;;0BACjB,8OAAC;gBAAI,WAAU;0BAAoE;;;;;;0BAGnF,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAI,WAAU;;;;;;wBACd,OAAO,CAAC,EAAE,EAAE,IAAI,CAAC,GAAG;4BACnB,MAAM,YAAY,QAAQ;4BAC1B,qBACE,8OAAC;gCAEC,WAAW,CAAC,uGAAuG,EACjH,YAAY,kBAAkB,IAC9B;0CAED,MAAM;+BALF;;;;;wBAQX;wBAEC,iIAAW,CAAC,GAAG,CAAC,CAAC,YAAY,oBAC5B,8OAAC;gCAEC,OAAO;gCACP,UAAU;gCACV,UAAU,OAAO,CAAC,IAAI;gCACtB,aAAa;gCACb,cAAc;+BALT;;;;;;;;;;;;;;;;;;;;;;AAYnB;AAUA,MAAM,MAAoB,CAAC,EACzB,KAAK,EACL,QAAQ,EACR,QAAQ,EACR,WAAW,EACX,YAAY,EACb;IACC,qBACE;;0BACE,8OAAC;gBAAI,WAAU;0BACZ;;;;;;YAEF,SAAS,GAAG,CAAC,CAAC,MAAM;gBACnB,MAAM,YAAY,QAAQ;gBAC1B,MAAM,WAAW,KAAK,MAAM;gBAC5B,qBACE,8OAAC;oBAEC,MAAK;oBACL,SAAS,IAAM,aAAa,UAAU;oBACtC,WAAW,CAAC,oDAAoD,EAC9D,WACI,uCACA,+BACL,CAAC,EAAE,YAAY,+BAA+B,IAAI;8BAElD,0BACC,8OAAC;wBAAK,WAAU;kCAA8C;;;;;;mBAV3D;;;;;YAgBX;;;AAGN"}},
    {"offset": {"line": 499, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Projects24/Code/Sequencer/components/InstrumentControls.tsx"],"sourcesContent":["import type { FC } from \"react\";\nimport {\n  INSTRUMENTS,\n  type InstrumentParamMap,\n  type InstrumentId,\n} from \"@/types/sequencer\";\n\ntype Props = {\n  params: InstrumentParamMap;\n  onChange: (next: InstrumentParamMap) => void;\n};\n\nexport const InstrumentControls: FC<Props> = ({ params, onChange }) => {\n  const handleChange = (\n    id: InstrumentId,\n    field: \"pitch\" | \"decay\" | \"timbre\",\n    value: number,\n  ) => {\n    const next: InstrumentParamMap = {\n      ...params,\n      [id]: {\n        ...params[id],\n        [field]: value,\n      },\n    };\n    onChange(next);\n  };\n\n  return (\n    <section className=\"mt-4 flex flex-col gap-2\">\n      <div className=\"font-mono text-[11px] uppercase tracking-[0.2em] text-neutral-500\">\n        Sound\n      </div>\n      <div className=\"grid grid-cols-1 gap-3 md:grid-cols-5\">\n        {INSTRUMENTS.map((id) => {\n          const p = params[id];\n          return (\n            <div\n              key={id}\n              className=\"rounded border border-neutral-200 bg-neutral-50 px-3 py-2\"\n            >\n              <div className=\"mb-1 text-[11px] capitalize text-neutral-700\">\n                {id}\n              </div>\n              <ControlRow\n                label=\"Pitch\"\n                min={-24}\n                max={24}\n                step={1}\n                value={p.pitch}\n                onChange={(v) => handleChange(id, \"pitch\", v)}\n              />\n              <ControlRow\n                label=\"Decay\"\n                min={0.1}\n                max={1.5}\n                step={0.05}\n                value={p.decay}\n                onChange={(v) => handleChange(id, \"decay\", v)}\n              />\n              <ControlRow\n                label=\"Timbre\"\n                min={0}\n                max={1}\n                step={0.05}\n                value={p.timbre}\n                onChange={(v) => handleChange(id, \"timbre\", v)}\n              />\n            </div>\n          );\n        })}\n      </div>\n    </section>\n  );\n};\n\ntype ControlRowProps = {\n  label: string;\n  min: number;\n  max: number;\n  step: number;\n  value: number;\n  onChange: (value: number) => void;\n};\n\nconst ControlRow: FC<ControlRowProps> = ({\n  label,\n  min,\n  max,\n  step,\n  value,\n  onChange,\n}) => {\n  return (\n    <label className=\"mt-1 flex items-center gap-2 text-[11px] text-neutral-600\">\n      <span className=\"w-12 font-mono text-[10px] uppercase tracking-[0.18em]\">\n        {label}\n      </span>\n      <input\n        type=\"range\"\n        min={min}\n        max={max}\n        step={step}\n        value={value}\n        onChange={(e) => onChange(Number(e.target.value))}\n        className=\"h-1 flex-1 accent-emerald-600\"\n      />\n      <span className=\"w-10 text-right font-mono text-[10px] text-neutral-700\">\n        {value.toFixed(2)}\n      </span>\n    </label>\n  );\n};\n"],"names":[],"mappings":";;;;;AACA;;;AAWO,MAAM,qBAAgC,CAAC,EAAE,MAAM,EAAE,QAAQ,EAAE;IAChE,MAAM,eAAe,CACnB,IACA,OACA;QAEA,MAAM,OAA2B;YAC/B,GAAG,MAAM;YACT,CAAC,GAAG,EAAE;gBACJ,GAAG,MAAM,CAAC,GAAG;gBACb,CAAC,MAAM,EAAE;YACX;QACF;QACA,SAAS;IACX;IAEA,qBACE,8OAAC;QAAQ,WAAU;;0BACjB,8OAAC;gBAAI,WAAU;0BAAoE;;;;;;0BAGnF,8OAAC;gBAAI,WAAU;0BACZ,iIAAW,CAAC,GAAG,CAAC,CAAC;oBAChB,MAAM,IAAI,MAAM,CAAC,GAAG;oBACpB,qBACE,8OAAC;wBAEC,WAAU;;0CAEV,8OAAC;gCAAI,WAAU;0CACZ;;;;;;0CAEH,8OAAC;gCACC,OAAM;gCACN,KAAK,CAAC;gCACN,KAAK;gCACL,MAAM;gCACN,OAAO,EAAE,KAAK;gCACd,UAAU,CAAC,IAAM,aAAa,IAAI,SAAS;;;;;;0CAE7C,8OAAC;gCACC,OAAM;gCACN,KAAK;gCACL,KAAK;gCACL,MAAM;gCACN,OAAO,EAAE,KAAK;gCACd,UAAU,CAAC,IAAM,aAAa,IAAI,SAAS;;;;;;0CAE7C,8OAAC;gCACC,OAAM;gCACN,KAAK;gCACL,KAAK;gCACL,MAAM;gCACN,OAAO,EAAE,MAAM;gCACf,UAAU,CAAC,IAAM,aAAa,IAAI,UAAU;;;;;;;uBA5BzC;;;;;gBAgCX;;;;;;;;;;;;AAIR;AAWA,MAAM,aAAkC,CAAC,EACvC,KAAK,EACL,GAAG,EACH,GAAG,EACH,IAAI,EACJ,KAAK,EACL,QAAQ,EACT;IACC,qBACE,8OAAC;QAAM,WAAU;;0BACf,8OAAC;gBAAK,WAAU;0BACb;;;;;;0BAEH,8OAAC;gBACC,MAAK;gBACL,KAAK;gBACL,KAAK;gBACL,MAAM;gBACN,OAAO;gBACP,UAAU,CAAC,IAAM,SAAS,OAAO,EAAE,MAAM,CAAC,KAAK;gBAC/C,WAAU;;;;;;0BAEZ,8OAAC;gBAAK,WAAU;0BACb,MAAM,OAAO,CAAC;;;;;;;;;;;;AAIvB"}},
    {"offset": {"line": 643, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Projects24/Code/Sequencer/app/page.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport {\n  createDefaultInstrumentParams,\n  createDefaultTransport,\n  createEmptyPattern,\n  NUM_STEPS,\n  type InstrumentParamMap,\n  type Pattern,\n} from \"@/types/sequencer\";\nimport { useToneEngine } from \"./hooks/useToneEngine\";\nimport { TransportControls } from \"@/components/TransportControls\";\nimport { PatternGrid } from \"@/components/PatternGrid\";\nimport { InstrumentControls } from \"@/components/InstrumentControls\";\n\nexport default function SequencerPage() {\n  const [pattern, setPattern] = useState<Pattern>(() => createEmptyPattern());\n  const [instrumentParams, setInstrumentParams] =\n    useState<InstrumentParamMap>(() => createDefaultInstrumentParams());\n\n  const engine = useToneEngine(\n    createDefaultTransport(),\n    pattern,\n    instrumentParams,\n  );\n\n  const handleToggleStep = (row: number, col: number) => {\n    setPattern((prev) => {\n      const next = prev.map((r) => r.map((s) => ({ ...s })));\n      next[row][col].active = !next[row][col].active;\n      engine.updatePattern(next);\n      return next;\n    });\n  };\n\n  const handleInstrumentParamsChange = (next: InstrumentParamMap) => {\n    setInstrumentParams(next);\n    engine.updateInstrumentParams(next);\n  };\n\n  return (\n    <main className=\"flex flex-1 flex-col gap-4\">\n      <header className=\"flex items-baseline justify-between border-b border-neutral-300 pb-4\">\n        <div>\n          <p className=\"text-xs uppercase tracking-[0.25em] text-neutral-500\">\n            Intersymmetric Works\n          </p>\n          <h1 className=\"text-sm font-medium tracking-[0.18em] text-neutral-800\">\n            Sequencer 01\n          </h1>\n        </div>\n        <div className=\"text-right text-xs text-neutral-500\">\n          <div>Room Code:</div>\n          <div className=\"font-mono text-[11px] tracking-widest\">solo</div>\n        </div>\n      </header>\n\n      <section className=\"flex flex-1 flex-col rounded-md border border-neutral-300 bg-white p-4 shadow-sm\">\n        <TransportControls\n          tempo={engine.transport.tempo}\n          startStep={engine.transport.startStep}\n          endStep={engine.transport.endStep}\n          maxSteps={NUM_STEPS}\n          isPlaying={engine.transport.isPlaying}\n          onTempoChange={engine.setTempo}\n          onRangeChange={engine.setRange}\n          onTogglePlay={engine.togglePlay}\n        />\n\n        <PatternGrid\n          pattern={pattern}\n          currentStep={engine.transport.currentStep}\n          onToggleStep={handleToggleStep}\n        />\n\n        <InstrumentControls\n          params={instrumentParams}\n          onChange={handleInstrumentParamsChange}\n        />\n\n        {!engine.ready && (\n          <p className=\"mt-4 text-xs text-neutral-400\">\n            Audio engine is loading in the background. You can already draw a\n            pattern; sound will start once it is ready.\n          </p>\n        )}\n      </section>\n    </main>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAQA;AACA;AACA;AACA;AAdA;;;;;;;;AAgBe,SAAS;IACtB,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAU,IAAM,IAAA,wIAAkB;IACxE,MAAM,CAAC,kBAAkB,oBAAoB,GAC3C,IAAA,iNAAQ,EAAqB,IAAM,IAAA,mJAA6B;IAElE,MAAM,SAAS,IAAA,8IAAa,EAC1B,IAAA,4IAAsB,KACtB,SACA;IAGF,MAAM,mBAAmB,CAAC,KAAa;QACrC,WAAW,CAAC;YACV,MAAM,OAAO,KAAK,GAAG,CAAC,CAAC,IAAM,EAAE,GAAG,CAAC,CAAC,IAAM,CAAC;wBAAE,GAAG,CAAC;oBAAC,CAAC;YACnD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM;YAC9C,OAAO,aAAa,CAAC;YACrB,OAAO;QACT;IACF;IAEA,MAAM,+BAA+B,CAAC;QACpC,oBAAoB;QACpB,OAAO,sBAAsB,CAAC;IAChC;IAEA,qBACE,8OAAC;QAAK,WAAU;;0BACd,8OAAC;gBAAO,WAAU;;kCAChB,8OAAC;;0CACC,8OAAC;gCAAE,WAAU;0CAAuD;;;;;;0CAGpE,8OAAC;gCAAG,WAAU;0CAAyD;;;;;;;;;;;;kCAIzE,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;0CAAI;;;;;;0CACL,8OAAC;gCAAI,WAAU;0CAAwC;;;;;;;;;;;;;;;;;;0BAI3D,8OAAC;gBAAQ,WAAU;;kCACjB,8OAAC,qJAAiB;wBAChB,OAAO,OAAO,SAAS,CAAC,KAAK;wBAC7B,WAAW,OAAO,SAAS,CAAC,SAAS;wBACrC,SAAS,OAAO,SAAS,CAAC,OAAO;wBACjC,UAAU,+HAAS;wBACnB,WAAW,OAAO,SAAS,CAAC,SAAS;wBACrC,eAAe,OAAO,QAAQ;wBAC9B,eAAe,OAAO,QAAQ;wBAC9B,cAAc,OAAO,UAAU;;;;;;kCAGjC,8OAAC,yIAAW;wBACV,SAAS;wBACT,aAAa,OAAO,SAAS,CAAC,WAAW;wBACzC,cAAc;;;;;;kCAGhB,8OAAC,uJAAkB;wBACjB,QAAQ;wBACR,UAAU;;;;;;oBAGX,CAAC,OAAO,KAAK,kBACZ,8OAAC;wBAAE,WAAU;kCAAgC;;;;;;;;;;;;;;;;;;AAQvD"}},
    {"offset": {"line": 799, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Projects24/Code/Sequencer/node_modules/next/src/server/route-modules/app-page/module.compiled.js"],"sourcesContent":["if (process.env.NEXT_RUNTIME === 'edge') {\n  module.exports = require('next/dist/server/route-modules/app-page/module.js')\n} else {\n  if (process.env.__NEXT_EXPERIMENTAL_REACT) {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo-experimental.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page-experimental.runtime.prod.js')\n      }\n    }\n  } else {\n    if (process.env.NODE_ENV === 'development') {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.dev.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.dev.js')\n      }\n    } else {\n      if (process.env.TURBOPACK) {\n        module.exports = require('next/dist/compiled/next-server/app-page-turbo.runtime.prod.js')\n      } else {\n        module.exports = require('next/dist/compiled/next-server/app-page.runtime.prod.js')\n      }\n    }\n  }\n}\n"],"names":["process","env","NEXT_RUNTIME","module","exports","require","__NEXT_EXPERIMENTAL_REACT","NODE_ENV","TURBOPACK"],"mappings":"AAAA,IAAIA,QAAQC,GAAG,CAACC,YAAY,KAAK,QAAQ;;KAElC;IACL,IAAIF,QAAQC,GAAG,CAACK,yBAAyB,EAAE;;SAcpC;QACL,IAAIN,QAAQC,GAAG,CAACM,QAAQ,KAAK,WAAe;YAC1C,IAAIP,QAAQC,GAAG,CAACO,SAAS,eAAE;gBACzBL,OAAOC,OAAO,GAAGC,QAAQ;YAC3B,OAAO;;QAGT,OAAO;;IAOT;AACF","ignoreList":[0]}},
    {"offset": {"line": 818, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Projects24/Code/Sequencer/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react-jsx-dev-runtime.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.ReactJsxDevRuntime\n"],"names":["module","exports","require","vendored","ReactJsxDevRuntime"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,kBAAkB","ignoreList":[0]}},
    {"offset": {"line": 823, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/Projects24/Code/Sequencer/node_modules/next/src/server/route-modules/app-page/vendored/ssr/react.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-ssr']!.React\n"],"names":["module","exports","require","vendored","React"],"mappings":"AAAAA,OAAOC,OAAO,GACZC,QAAQ,4HACRC,QAAQ,CAAC,YAAY,CAAEC,KAAK","ignoreList":[0]}}]
}